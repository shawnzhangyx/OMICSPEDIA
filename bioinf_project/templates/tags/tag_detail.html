{% extends 'tags/tag_base.html' %}
{% load staticfiles %}
{% load tag_custom_tags %}
{% load post_custom_tags %}
{% load wiki_custom_tags %}
{% load util_custom_tags %}
{% block content %}

<h2> {% show_tag_ancestor tag %} {{ tag.name }} <small> {% if tag.wiki_page.software %}&lt;<a title="go to software page" href="{% url 'software:software-detail' tag.wiki_page.software.name %}">software</a>&gt; {% endif %}
</small> 
  
    {% if perms.tags.delete_tag %}
<a class="btn btn-xs btn-default" href="{% url 'tags:tag-edit' tag.name %}">Edit</a>
<a class="btn btn-xs btn-default" href = "{% url 'tags:tag-delete' name=tag.name %}">Delete? </a>
{% endif %}
{% if tag.get_category_display == "workflow"%}

<a class="btn btn-xs btn-primary"  href="{% url 'tags:tag-create' parent_name=tag.name %}"> Create new tag under this tag?</a>
{% endif %}
</h2>
<hr>
<div class="vote-box">
    {% display_bookmark_widget tag.wiki_page user %}
</div>
 {% if tag.wiki_page == null %}
  There is no description of this tag, please add a <a href="{% url 'tags:tag-edit' tag.name %}">wiki</a> page to it. 
  {% else %}
  <div class="pull-left">
{{tag.wiki_page.get_lead_section|safe}} 
</div>
 <a href="{% url 'wiki:wiki-detail' tag.wiki_page.get_title %}">&nbsp;[tag wiki]</a> 
  {% endif %}

<br><br><br><br>
  <ul class="nav nav-tabs">
    <li {% ifequal tab "Summary" %} class="active" {% endifequal %}
    {% ifequal tab null %} class="active" {% endifequal %}>
      <a href="?tab=Summary"> Summary </a> </li>
    <li {% ifequal tab "Wiki" %} class="active" {% endifequal %}> 
      <a href="?tab=Wiki"> Wiki  </a> </li>
    <li {% ifequal tab "Questions" %} class="active" {% endifequal %} >
        <a href="?tab=Questions"> Questions  </a> </li>
    <li {% ifequal tab "Discussions" %} class="active" {% endifequal %} >
        <a href="?tab=Discussions"> Discussions  </a> </li>
    <li {% ifequal tab "Blogs" %} class="active" {% endifequal %} >
        <a href="?tab=Blogs"> Blogs  </a> </li>
    <li {% ifequal tab "Contributors" %} class="active" {% endifequal %} >
        <a href="?tab=Contributors"> Contributors </a> </li>
  </ul>

{% ifequal tab "Summary" %}

<p> This is the Summary page of the tag: </p>
 <div class="row"> 
   <div class="section-tab col-sm-6">
    <h3> <a href="?tab=Wiki">{{wiki_list.count}} wiki page{% if wiki_list.count > 1%}s{% endif %}</a> </h3>
    <ul class="list-unstyled">
    {% for wiki in wiki_list|slice:":5" %}
    <li>    {% show_wiki_tab wiki %} </li>
    {% endfor %}    
    </ul>
   </div>
   <div class="section-tab col-sm-6">
    <h3> <a href="?tab=Questions">{{question_list.count}} question{% if question_list.count > 1 %}s{% endif %}</a></h3>
    {% for question in question_list|slice:":5" %}
        {% show_post_tab_sm question %}
    {% endfor %}
   </div>
   <div class="clearfix visible-sm-block visible-md-block visible-lg-block"></div>

   <div class="section-tab col-sm-6">
    <h3> <a href="?tab=Discussions">{{discussion_list.count}} discussion{% if discussion_list.count > 1 %}s{% endif %}</a></h3>
    {% for discussion in discussion_list|slice:":5" %}
        {% show_post_tab_sm discussion %}
    {% endfor %}
   </div>
   <div class="section-tab col-sm-6">
    <h3> <a href="?tab=Blogs">{{blog_list.count}} blog{% if blog_list.count > 1 %}s{% endif %}</a></h3>
    {% for blog in blog_list|slice:":5" %}
        {% show_post_tab_sm blog %}
    {% endfor %}
   </div>
   <div class="clearfix visible-sm-block visible-md-block visible-lg-block"></div>
   
    <div class="section-tab col-sm-6">
    <h3> <a href="?tab=Contributors">{{usertag_list.count}} contributor{% if usertag_list.count > 1%}s{% endif %}</a> </h3>
    <ul class="list-unstyled" >
    {% for user_tag in usertag_list|slice:":5" %}
        {% user_answers_for_tag user_tag %}
    {% endfor %}
    </ul>
    </div>
</div>

{% endifequal %}

{% ifequal tab "Wiki"%}
  <br>  
  <ul>
  {% for wiki in wiki_list %}
  {% show_wiki_tab wiki %}
  {% empty%}
  No wiki associated with this tag yet. Would you like to suggest adding some tags to these <a href=""> articles?</a>
  {% endfor%}
  </ul>
{% endifequal %}

{% if tab == "Questions"%}
<div class="container-fluid">
{% for question in question_list %}
  {% show_post_tab question %}
{% empty %}
No posts associated with this tag yet. Would you like to suggest adding some tags to these <a href="">posts? </a>
{% endfor %}
</div>
{% endif %}
{% if tab == "Discussions"%}
<div class="container-fluid">
{% for discussion in discussion_list %}
  {% show_post_tab discussion %}
{% empty %}
No posts associated with this tag yet. Would you like to suggest adding some tags to these <a href="">posts? </a>
{% endfor %}
</div>
{% endif %}
{% if tab == "Blogs"%}
<div class="container-fluid">
{% for blog in blog_list %}
  {% show_post_tab blog %}
{% empty %}
No posts associated with this tag yet. Would you like to suggest adding some tags to these <a href="">posts? </a>
{% endfor %}
</div>
{% endif %}

{% if tab == "Contributors"%}
<br>
<div>
    <ul class="list-unstyled">
{% for usertag in usertag_list %}
        {% user_answers_for_tag usertag %}
{% empty %}
No posts associated with this tag yet. Would you like to suggest adding some tags to these <a href="">posts? </a>
{% endfor %}
</ul>
</div>
{% endif %}

      {% if is_paginated %}
        <div class="pagination">
            <span class="page-links">
                {% if page_obj.has_previous %}
                    <a class='btn btn-xs btn-default' href="{% url 'posts:post-index'%}?tab={{tab}}&page={{ page_obj.previous_page_number }}">Prev</a>
                {% endif %}
                <span class="page-current">
                    Page <b>{{ page_obj.number }}</b> of <b>{{ page_obj.paginator.num_pages }}</b>.
                </span>
                {% if page_obj.has_next %}
                    <a class='btn btn-xs btn-default' href="{% url 'posts:post-index'%}?tab={{tab}}&page={{ page_obj.next_page_number }}">Next</a>
                {% endif %}
                <form action="" class="pagination-form" method="get">  <input type="text" size="1" name="page" placeholder="1"> <input style="display:none" type="text" size="1" name="tab" value="{{tab}}"> <input type="submit" class="btn btn-default btn-xs" value="Go">
                </form>
            </span>
        </div>
    {% endif %}
    
{% endblock content %}

{% block jquery %}
  <script src="{% static 'jquery/vote_widget.js' %}"> </script>
{% endblock jquery %}